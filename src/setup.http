### =======================================
### SETUP SCRIPT
### =======================================
# Run this file once to create all necessary data.
# Copy the IDs logged in the console for the next script.

### 1. Register ADMINISTRATOR
# @name registerAdmin
POST http://localhost:8080/api/v1/auth/register
Content-Type: application/json

{
  "firstName": "Admin",
  "lastName": "User",
  "email": "admin@example.com",
  "password": "password123",
  "role": "ADMINISTRATOR"
}

> {%
    client.global.set("admin_jwt", response.body.token);
    client.log("✅ Admin User Registered.");
%}
###

### 2. Register ATTENDEE
# @name registerAttendee
POST http://localhost:8080/api/v1/auth/register
Content-Type: application/json

{
  "firstName": "Attendee",
  "lastName": "One",
  "email": "attendee1@example.com",
  "password": "password123",
  "role": "ATTENDEE"
}

> {%
    client.global.set("attendee_jwt", response.body.token);
    client.log(response.body.token)
    client.log("✅ Attendee User Registered.");
%}
###

### 3. Get all users to find the Attendee's ID
# @name getUsers
GET http://localhost:8080/api/v1/users
Authorization: Bearer {{admin_jwt}}

> {%
    const attendee = response.body.find(u => u.email === "attendee1@example.com");
    client.global.set("attendeeId", attendee.id);
    client.log("❗ COPY THIS ATTENDEE ID: " + attendee.id);
%}
###

### 4. Create a Venue
# @name createVenue
POST http://localhost:8080/api/v1/venues
Content-Type: application/json
Authorization: Bearer {{admin_jwt}}

{
  "name": "Main Campus Auditorium",
  "latitude": -6.7766,
  "longitude": 39.2312,
  "radius": 100
}

> {%
    client.global.set("venueId", response.body.id);
    client.log("❗ COPY THIS VENUE ID: " + response.body.id);
%}
###

### 5. Create a Group
# @name createGroup
POST http://localhost:8080/api/v1/groups
Content-Type: application/json
Authorization: Bearer {{admin_jwt}}

{
  "name": "Java IPT - Fall 2025",
  "description": "The cohort for the Industrial Practical Training."
}

> {%
    client.global.set("groupId", response.body.id);
    client.log("❗ COPY THIS GROUP ID: " + response.body.id);
%}
###

### 6. Add Attendee to Group
POST http://localhost:8080/api/v1/groups/{{groupId}}/members
Content-Type: application/json
Authorization: Bearer {{admin_jwt}}

{
  "userId": "{{attendeeId}}"
}

> {% client.log("✅ Attendee added to group. Setup is complete."); %}
###